<!DOCTYPE html>
<html lang="nl"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">

    <title>Winkelmandje - Rental Platform</title>

    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:'Segoe UI',Arial;background:#f4f6f8;color:#111;}
        a{text-decoration:none;color:inherit;}

        nav{
            background:#1c1c1c;color:white;padding:15px 26px;
            display:flex;justify-content:space-between;align-items:center;
            box-shadow:0 2px 8px rgba(0,0,0,0.35);
            animation:fadeDown .4s ease;
        }
        @keyframes fadeDown{from{opacity:0;transform:translateY(-10px);}to{opacity:1;transform:translateY(0);}}

        nav a{margin-right:18px;color:#d6d6d6;font-weight:500;transition:.2s;}
        nav a:hover{color:#fff;}

        nav form button{background:none;border:none;color:#ddd;font-size:15px;cursor:pointer;transition:.2s;}
        nav form button:hover{color:#fff;}

        .container{
            width:95%;max-width:1100px;margin:35px auto;
            animation:fadeIn .4s ease-out;
        }
        @keyframes fadeIn{from{opacity:0;transform:translateY(12px);}to{opacity:1;transform:translateY(0);}}

        h1{margin-bottom:20px;}

        table{
            width:100%;border-collapse:collapse;background:white;
            border-radius:12px;overflow:hidden;
            box-shadow:0 3px 10px rgba(0,0,0,0.12);margin-bottom:20px;
        }
        table th,table td{
            padding:14px 16px;border-bottom:1px solid #ececec;
        }
        table th{
            background:#f5f5f5;font-weight:600;text-align:left;
        }
        table tr:last-child td{border-bottom:none;}
        .text-right{text-align:right;}

        .btn{
            padding:10px 16px;border-radius:7px;background:#1e88e5;
            color:white;font-weight:600;font-size:15px;cursor:pointer;
            border:none;transition:.2s ease;display:inline-block;
        }
        .btn:hover{background:#1565c0;transform:translateY(-1px);}
        .btn:active{transform:scale(0.97);}

        .btn-secondary{background:#e0e0e0;color:#333;}
        .btn-secondary:hover{background:#c5c5c5;}

        .btn-remove{background:#e53935;}
        .btn-remove:hover{background:#c62828;}

        .empty{
            background:white;padding:22px;border-radius:12px;
            box-shadow:0 3px 10px rgba(0,0,0,0.12);
            margin-bottom:20px;text-align:center;
            animation:fadeUp .4s ease;
        }

        @keyframes fadeUp{
            from{opacity:0;transform:translateY(12px);}
            to{opacity:1;transform:translateY(0);}
        }

        .total-box{
            margin-top:18px;background:white;padding:18px;border-radius:12px;
            display:flex;justify-content:space-between;
            box-shadow:0 3px 10px rgba(0,0,0,0.10);font-size:16px;
            animation:fadeIn .4s ease-out;
        }
        .total-label{font-weight:600;}
        .total-amount{font-weight:700;}

        .actions{margin-top:22px;display:flex;gap:10px;}
        .actions a{flex:1;text-align:center;}

        #snackbar{
            visibility:hidden;min-width:260px;background:#333;color:#fff;
            text-align:center;border-radius:8px;
            padding:12px;position:fixed;z-index:9999;
            left:50%;bottom:30px;transform:translateX(-50%);
            opacity:0;transition:opacity .4s,bottom .4s;
        }
        #snackbar.show{
            visibility:visible;opacity:1;bottom:50px;
        }
    </style>

    <script>
        function showRemoveSnackbar() {
            let bar = document.getElementById('snackbar');
            bar.innerText = "Item verwijderd uit winkelmandje";
            bar.classList.add('show');
            setTimeout(() => bar.classList.remove('show'), 2500);
        }
    </script>

</head>

<body>

<nav>
    <div>
        <a href="/catalog">Catalogus</a>

        <a href="/cart" style="position:relative;display:inline-block;">
            <svg xmlns="http://www.w3.org/2000/svg"
                 viewBox="0 0 24 24" height="22" width="22">
                <path fill="#d6d6d6" d="M7 18c-1.1 0-1.99..."/>
            </svg>
            <span th:if="${cartCount>0}" th:text="${cartCount}"
                  style="
                          position:absolute;top:-6px;right:-10px;
                          background:#43a047;color:white;
                          padding:3px 7px;font-size:11px;border-radius:50%;
                          font-weight:700;">
            </span>
        </a>

        <a href="/orders" sec:authorize="isAuthenticated()">Mijn reservaties</a>
    </div>

    <div>
        <span sec:authorize="!isAuthenticated()">
            <a href="/login">Inloggen</a>
            <a href="/register">Registreren</a>
        </span>

        <span sec:authorize="isAuthenticated()">
            Ingelogd als <strong sec:authentication="name"></strong> |
            <form th:action="@{/logout}" method="post" style="display:inline;">
                <button>Uitloggen</button>
            </form>
        </span>
    </div>
</nav>

<div id="snackbar"></div>

<div class="container">

    <h1>Winkelmandje</h1>

    <div th:if="${#lists.isEmpty(items)}" class="empty">
        <p>Je winkelmandje is momenteel leeg.</p><br>
        <a href="/catalog" class="btn">Terug naar catalogus</a>
    </div>

    <div th:if="${!#lists.isEmpty(items)}">

        <table>
            <tr>
                <th>Product</th>
                <th>Aantal</th>
                <th class="text-right">Prijs per dag</th>
                <th class="text-right">Subtotaal</th>
                <th></th>
            </tr>

            <tr th:each="item : ${items}">
                <td th:text="${item.product.name}"></td>
                <td th:text="${item.quantity}"></td>

                <td class="text-right"
                    th:text="${#numbers.formatDecimal(item.product.dailyPrice,1,'COMMA',2,'POINT')} + ' €'">
                </td>

                <td class="text-right"
                    th:text="${#numbers.formatDecimal(item.product.dailyPrice * item.quantity,1,'COMMA',2,'POINT')} + ' €'">
                </td>

                <td class="text-right">
                    <a th:href="@{'/cart/remove/' + ${item.product.id}}"
                       class="btn btn-remove"
                       onclick="showRemoveSnackbar()">
                        Verwijderen
                    </a>
                </td>
            </tr>
        </table>

        <div class="total-box">
            <span class="total-label">Totaal per dag:</span>
            <span class="total-amount"
                  th:text="${#numbers.formatDecimal(total,1,'COMMA',2,'POINT')} + ' €'"></span>
        </div>

        <div class="actions">
            <a href="/catalog" class="btn-secondary btn">Verder winkelen</a>
            <a href="/cart/checkout" class="btn">Verder naar checkout</a>
        </div>

    </div>

</div>

</body>
</html>
